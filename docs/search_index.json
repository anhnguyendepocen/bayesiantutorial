[
["index.html", "Bayesian Tutorial Welcome", " Bayesian Tutorial Devin Pastoor Welcome This tutorial is a reasonably self-contained tutorial and documentation source about trasitioning to bayesian analysis from traditional first order estimation techniques for nonlinear-mixed-effects modeling. The overarching objective is to provide a resource for some of the additional complexity that bayesian analysis suggests/requires (mu-modeling, additional estimation tuning, etc) and to compare output under various scenarios to that of FOCE-based estimation. As a secondary objective, this project should serve as a case study to managing a collaborative project using git, github and other ‘modern’ tooling for reproducible science. For contribution guidelines, see the CONTRIBUTING section below. This work is licensed under the Creative Commons Attribution-NonCommercial-NoDerivs 3.0 United States License. "],
["steps.html", "1 Steps", " 1 Steps As a primary outcome of this tutorial is to understand the bayesian requirements for modeling vancomycin in neonates for bayesian forecasting dose recommendations, the data and parameter values will use existing vancomycin values to get in the ballpark of outcomes to be expected from real data. At a very high level, the following steps must be done: Data Generation Generate covariate distributions Simulate profiles for population of neonates Scenario ‘filters’ sampling times balance of peak/trough dose modifications? Model fitting via FOCE model building covariate model building proper diagnostic analyses for evaluating model adequacy/selection Model fitting via Bayes model building covariate model building prior selection proper diagnostic analyses for evaluating model adequacy/selection Model forecasting how to handle propogation of uncertainity for probability of target attainment (PTA) influence of PTA output on recommendations (dose and future sampling) "],
["demographics-background.html", "2 Demographics Background", " 2 Demographics Background library(knitr) library(PKPDmisc) library(tidyverse) source(&quot;../scripts/generate_demographics.R&quot;) #&gt; #&gt; Attaching package: &#39;magrittr&#39; #&gt; The following object is masked from &#39;package:purrr&#39;: #&gt; #&gt; set_names #&gt; The following object is masked from &#39;package:tidyr&#39;: #&gt; #&gt; extract The following covariance matrix was generated from fitting the baseline demographics from a couple hundred neonates in a hospital setting, primarily the NICU. sample_ids &lt;- generate_demographics(500) %&gt;% ## generate males and females mutate(SEX = factor(rbernoulli(nrow(.)), labels = c(&quot;FEMALE&quot;, &quot;MALE&quot;))) This functionality is encapsulated in the script generate_demographics.R for use in other files. GGally::ggpairs(sample_ids) #&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. #&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. #&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. #&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. #&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. kable(head(sample_ids)) WT CRE AGE PMA HT SEX 3.263 0.557 9.99 270 45.9 FEMALE 4.389 0.423 55.58 348 51.0 MALE 2.659 0.720 36.76 242 53.1 FEMALE 0.921 0.643 39.31 241 34.4 FEMALE 2.898 0.269 33.18 279 41.5 FEMALE 3.941 0.563 31.29 256 58.3 MALE devtools::session_info() #&gt; Session info -------------------------------------------------------------- #&gt; setting value #&gt; version R version 3.3.2 (2016-10-31) #&gt; system x86_64, mingw32 #&gt; ui RTerm #&gt; language (EN) #&gt; collate English_United States.1252 #&gt; tz America/New_York #&gt; date 2016-12-06 #&gt; Packages ------------------------------------------------------------------ #&gt; package * version date source #&gt; backports 1.0.4 2016-10-24 CRAN (R 3.3.2) #&gt; bookdown 0.2 2016-11-12 CRAN (R 3.3.2) #&gt; devtools 1.12.0 2016-06-24 CRAN (R 3.3.2) #&gt; digest 0.6.10 2016-08-02 CRAN (R 3.3.2) #&gt; evaluate 0.10 2016-10-11 CRAN (R 3.3.2) #&gt; htmltools 0.3.5 2016-03-21 CRAN (R 3.3.2) #&gt; httpuv 1.3.3 2015-08-04 CRAN (R 3.3.2) #&gt; knitr 1.15 2016-11-09 CRAN (R 3.3.2) #&gt; magrittr 1.5 2014-11-22 CRAN (R 3.3.2) #&gt; memoise 1.0.0 2016-01-29 CRAN (R 3.3.2) #&gt; mime 0.5 2016-07-07 CRAN (R 3.3.2) #&gt; miniUI 0.1.1 2016-01-15 CRAN (R 3.3.2) #&gt; R6 2.2.0 2016-10-05 CRAN (R 3.3.2) #&gt; Rcpp 0.12.8 2016-11-17 CRAN (R 3.3.2) #&gt; rmarkdown 1.2 2016-11-21 CRAN (R 3.3.2) #&gt; rprojroot 1.1 2016-10-29 CRAN (R 3.3.2) #&gt; shiny 0.14.2 2016-11-01 CRAN (R 3.3.2) #&gt; stringi 1.1.2 2016-10-01 CRAN (R 3.3.2) #&gt; stringr 1.1.0 2016-08-19 CRAN (R 3.3.2) #&gt; withr 1.0.2 2016-06-20 CRAN (R 3.3.2) #&gt; xtable 1.8-2 2016-02-05 CRAN (R 3.3.2) #&gt; yaml 2.1.13 2014-06-12 CRAN (R 3.3.2) "],
["dataset-creation.html", "3 Dataset Creation 3.1 Generate data for mrgsolve", " 3 Dataset Creation library(knitr) library(PKPDmisc) library(tidyverse) library(vancomycin) library(mrgsolve) source(&quot;../scripts/generate_demographics.R&quot;) #&gt; #&gt; Attaching package: &#39;magrittr&#39; #&gt; The following object is masked from &#39;package:purrr&#39;: #&gt; #&gt; set_names #&gt; The following object is masked from &#39;package:tidyr&#39;: #&gt; #&gt; extract models &lt;- source(&quot;../models/models.R&quot;)$value #&gt; model dir set to C:/Users/devin/Documents/Repos/bayesiantutorial/models #&gt; cache location set to C:\\Users\\devin\\Documents\\Repos\\bayesiantutorial\\models\\.modelcache #&gt; Compiling vanc_stockmann ... #&gt; done. 3.1 Generate data for mrgsolve start with a baseline of having 100 individuals worth of data, can scale to different amounts of individuals later set.seed(1234567) NIDS &lt;- 100 demogs &lt;- generate_demographics(NIDS) %&gt;% mutate(ID = 1:nrow(.), PMA = PMA/7 # in weeks for stockmann model ) for_dosing &lt;- demogs %&gt;% mutate( CMT = 1, EVID = 1, TIME = 0 ) %&gt;% select(ID, everything()) all_dosing &lt;- for_dosing %&gt;% group_by(ID) %&gt;% nest() %&gt;% mutate(dose = map(data, ~ dosing_6bin_pna_wt(.$AGE, .$WT)) ) %&gt;% unnest() Dose for 8 days all_dosing &lt;- all_dosing %&gt;% mutate(addl = as.integer(ceiling(24/II*8))) kable(head(all_dosing, n = 15)) ID WT CRE AGE PMA HT SEX CMT EVID TIME DOSE II addl 1 1.74 0.972 16.13 35.7 39.5 FEMALE 1 1 0 26.1 12 16 2 2.54 0.472 31.81 40.1 53.2 FEMALE 1 1 0 38.1 8 24 3 3.62 0.377 16.79 37.0 48.1 FEMALE 1 1 0 54.3 8 24 4 1.78 0.302 8.86 33.0 38.3 FEMALE 1 1 0 26.7 12 16 5 3.34 0.254 15.48 41.4 39.6 FEMALE 1 1 0 50.1 8 24 6 2.66 0.604 32.57 35.9 51.9 FEMALE 1 1 0 39.9 8 24 7 2.32 0.674 3.53 38.1 45.8 MALE 1 1 0 34.9 12 16 8 3.31 0.375 58.36 42.0 45.5 FEMALE 1 1 0 49.6 8 24 9 2.19 0.774 6.37 30.9 28.6 MALE 1 1 0 32.9 12 16 10 2.33 1.289 12.62 35.4 44.3 FEMALE 1 1 0 34.9 8 24 11 2.52 0.219 65.33 41.2 46.6 MALE 1 1 0 37.8 8 24 12 6.92 0.558 96.26 60.0 69.0 MALE 1 1 0 103.8 8 24 13 1.47 0.932 7.76 31.4 34.1 FEMALE 1 1 0 22.1 12 16 14 3.26 0.262 25.95 38.5 60.2 FEMALE 1 1 0 48.9 8 24 15 3.14 0.391 68.77 41.7 44.7 MALE 1 1 0 47.2 8 24 vanc_stockmann &lt;- models$use(&quot;vanc_stockmann&quot;) Normalize column capitalizations to make mrgsolve happy mrg_data &lt;- bind_cols( all_dosing %&gt;% select(ID), all_dosing %&gt;% select(everything(), -ID) %&gt;% lowercase_names() ) %&gt;% mutate(amt = dose) raw_sim &lt;- vanc_stockmann %&gt;% data_set(mrg_data) %&gt;% mrgsim(end = 10*24, delta = 2) %&gt;% as.data.frame %&gt;% as_data_frame %&gt;% capitalize_names() #&gt; Dropping non-numeric columns: sex 3.1.1 Check distribution of trough values at SS peak_trough &lt;- raw_sim %&gt;% filter(between(TIME, 150, 200)) %&gt;% select(ID, TIME, CP, DV) %&gt;% gather(obs, value, CP, DV) %&gt;% group_by(ID, obs) %&gt;% summarize(ctrough = min(value), cmax = max(value)) Peak and trough values are representative of real observations peak_trough %&gt;% gather(sample, value, ctrough, cmax) %&gt;% ggplot(aes(x = value)) + geom_density(aes(fill = obs), alpha = 0.6) + facet_wrap(~sample, scales = &quot;free&quot;) + theme_bw() + base_theme() take simulated values and prepare for nonmem estimation from_sim &lt;- raw_sim %&gt;% distinct(ID, TIME, DV) from_orig &lt;- mrg_data %&gt;% capitalize_names() %&gt;% select( ID, TIME, WT, CRE, AGE, PMA, HT, SEX, CMT, DOSE, II, ADDL ) data_for_nonmem &lt;- left_join(from_sim, from_orig) %&gt;% group_by(ID) %&gt;% fill(WT:CMT) %&gt;% mutate( EVID = ifelse(DV == 0, 1, 0) ) %&gt;% ## don&#39;t need to go too far after final dose for estimation purposes ## also don&#39;t n filter(TIME &lt; 216) %&gt;% ## don&#39;t need 0 concentration time point as not realistic distinct(ID, TIME, .keep_all = TRUE) #&gt; Joining, by = c(&quot;ID&quot;, &quot;TIME&quot;) 3.1.2 write data for nonmem write_nonmem(data_for_nonmem, &quot;../modeling/mdata/rich_100.csv&quot;) devtools::session_info() #&gt; Session info -------------------------------------------------------------- #&gt; setting value #&gt; version R version 3.3.2 (2016-10-31) #&gt; system x86_64, mingw32 #&gt; ui RTerm #&gt; language (EN) #&gt; collate English_United States.1252 #&gt; tz America/New_York #&gt; date 2016-12-06 #&gt; Packages ------------------------------------------------------------------ #&gt; package * version date #&gt; assertthat 0.1 2013-12-06 #&gt; backports 1.0.4 2016-10-24 #&gt; bookdown 0.2 2016-11-12 #&gt; codetools 0.2-15 2016-10-05 #&gt; colorspace 1.2-7 2016-10-11 #&gt; DBI 0.5-1 2016-09-10 #&gt; devtools 1.12.0 2016-06-24 #&gt; digest 0.6.10 2016-08-02 #&gt; dplyr * 0.5.0 2016-06-24 #&gt; evaluate 0.10 2016-10-11 #&gt; ggplot2 * 2.1.0.9001 2016-11-07 #&gt; gtable 0.2.0 2016-02-26 #&gt; highr 0.6 2016-05-09 #&gt; htmltools 0.3.5 2016-03-21 #&gt; httpuv 1.3.3 2015-08-04 #&gt; knitr * 1.15 2016-11-09 #&gt; labeling 0.3 2014-08-23 #&gt; lazyeval 0.2.0 2016-06-12 #&gt; magrittr * 1.5 2014-11-22 #&gt; MASS 7.3-45 2016-04-21 #&gt; memoise 1.0.0 2016-01-29 #&gt; mime 0.5 2016-07-07 #&gt; miniUI 0.1.1 2016-01-15 #&gt; mrgsolve * 0.7.6.9029 2016-12-06 #&gt; munsell 0.4.3 2016-02-13 #&gt; overseer * 0.0.1 2016-12-06 #&gt; PKPDmisc * 0.4.4.9000 2016-11-02 #&gt; plyr 1.8.4 2016-06-08 #&gt; purrr * 0.2.2 2016-06-18 #&gt; R6 2.2.0 2016-10-05 #&gt; Rcpp 0.12.8 2016-11-17 #&gt; RcppArmadillo 0.7.500.0.0 2016-10-22 #&gt; readr * 1.0.0 2016-08-03 #&gt; rmarkdown 1.2 2016-11-21 #&gt; rprojroot 1.1 2016-10-29 #&gt; scales 0.4.0.9003 2016-11-07 #&gt; shiny 0.14.2 2016-11-01 #&gt; stringi 1.1.2 2016-10-01 #&gt; stringr 1.1.0 2016-08-19 #&gt; tibble * 1.2 2016-08-26 #&gt; tidyr * 0.6.0 2016-08-12 #&gt; tidyverse * 1.0.0 2016-09-09 #&gt; vancomycin * 0.0.2 2016-11-08 #&gt; withr 1.0.2 2016-06-20 #&gt; xtable 1.8-2 2016-02-05 #&gt; yaml 2.1.13 2014-06-12 #&gt; source #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; Github (hadley/ggplot2@70c3d69) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; Github (metrumresearchgroup/mrgsolve@d92f31a) #&gt; CRAN (R 3.3.2) #&gt; local #&gt; Github (dpastoor/PKPDmisc@beae2a6) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; Github (hadley/scales@d58d83a) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; Github (dpastoor/vancomycin@2436cb6) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) #&gt; CRAN (R 3.3.2) "]
]
