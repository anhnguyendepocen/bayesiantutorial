# Dataset Creation

```{r message=FALSE}
library(knitr)
library(PKPDmisc)
library(tidyverse)
library(vancomycin)
```

```{r}
source("../scripts/generate_demographics.R")
```

## Generate data for mrgsolve

start with a baseline of having 100 individuals worth of data, can scale to 
different amounts of individuals later

```{r}
NIDS <- 10000
```

```{r}
demogs <- generate_demographics(NIDS) %>% mutate(ID = 1:nrow(.))
```

```{r}
for_dosing <- demogs %>% 
                  mutate(
                      CMT = 1, 
                      EVID = 1,
                      TIME = 0
                  ) %>% select(ID, everything())
```


```{r }
all_dosing <- for_dosing %>% group_by(ID) %>%
    nest() %>%
    mutate(dose = map(data, ~ dosing_6bin_pna_wt(.$AGE, .$WT))
           ) %>% unnest()
```

Dose for 8 days
```{r}
all_dosing <- all_dosing %>% 
  mutate(addl = 24/II*8) 
```

```{r}
all_dosing
```

```{r cache = FALSE}
devtools::session_info()
```
